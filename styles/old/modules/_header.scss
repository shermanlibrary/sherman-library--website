/* ==================
 * $HEADER
 * ================== */
header[role="banner"] {

    @include breakpoint(snapscreen) {
        position: relative;
        visibility: visible;

        .menu { font-size: 16px; }
    }
}


/* ==================
 * Javascript disabled,
 * Hover enabled 
 */

.no-js .utilities > ul > li:hover {

    .sub-menu {
        display: block;
    }

}


 /* ==================
 * Navigation
 * ================== */
.ie .menu { font-family: $ie-sans-stack; filter:none; }
.lt-ie9 .menu  {
    border-bottom: 1px solid $polaris-blue-dark;
    border-top: 1px solid $polaris-blue-dark;
}
.menu {

    background: #3366cc; /* Old browsers */
    /* IE9 SVG, needs conditional override of 'filter' to 'none' */
    background: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/Pgo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgdmlld0JveD0iMCAwIDEgMSIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI+CiAgPGxpbmVhckdyYWRpZW50IGlkPSJncmFkLXVjZ2ctZ2VuZXJhdGVkIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeDE9IjAlIiB5MT0iMCUiIHgyPSIxMDAlIiB5Mj0iMCUiPgogICAgPHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iIzMzNjZjYyIgc3RvcC1vcGFjaXR5PSIxIi8+CiAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiMyMTM0OGEiIHN0b3Atb3BhY2l0eT0iMSIvPgogIDwvbGluZWFyR3JhZGllbnQ+CiAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEiIGhlaWdodD0iMSIgZmlsbD0idXJsKCNncmFkLXVjZ2ctZ2VuZXJhdGVkKSIgLz4KPC9zdmc+);
    background: -moz-linear-gradient(left,  #3366cc 0%, #21348a 100%); /* FF3.6+ */
    background: -webkit-gradient(linear, left top, right top, color-stop(0%,#3366cc), color-stop(100%,#21348a)); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(left,  #3366cc 0%,#21348a 100%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(left,  #3366cc 0%,#21348a 100%); /* Opera 11.10+ */
    background: -ms-linear-gradient(left,  #3366cc 0%,#21348a 100%); /* IE10+ */
    background: linear-gradient(to right,  #3366cc 0%,#21348a 100%); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#3366cc', endColorstr='#21348a',GradientType=1 ); /* IE6-8 */

        color: white;
    //box-shadow: inset 0 0 2px 0 #000;
    font-family: $sans-stack;
    line-height: 2;
    margin-bottom: 1em;
    z-index: 1000;
    /* Removed 5/8/2013
    url('textures/noise.png'), 
    url('textures/noise.png'), 
    url('textures/noise.png'), 
    url('textures/noise.png'), 
    url('textures/noise.png'), 
    url('textures/noise.png'), 
    */

    &:after {background: #21348a; /* Old browsers */
/* IE9 SVG, needs conditional override of 'filter' to 'none' */
background: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/Pgo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgdmlld0JveD0iMCAwIDEgMSIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI+CiAgPGxpbmVhckdyYWRpZW50IGlkPSJncmFkLXVjZ2ctZ2VuZXJhdGVkIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeDE9IjAlIiB5MT0iMCUiIHgyPSIxMDAlIiB5Mj0iMTAwJSI+CiAgICA8c3RvcCBvZmZzZXQ9IjElIiBzdG9wLWNvbG9yPSIjMjEzNDhhIiBzdG9wLW9wYWNpdHk9IjEiLz4KICAgIDxzdG9wIG9mZnNldD0iNTAlIiBzdG9wLWNvbG9yPSIjMzM2NmNjIiBzdG9wLW9wYWNpdHk9IjEiLz4KICAgIDxzdG9wIG9mZnNldD0iMTAwJSIgc3RvcC1jb2xvcj0iIzFmYmFmMiIgc3RvcC1vcGFjaXR5PSIxIi8+CiAgPC9saW5lYXJHcmFkaWVudD4KICA8cmVjdCB4PSIwIiB5PSIwIiB3aWR0aD0iMSIgaGVpZ2h0PSIxIiBmaWxsPSJ1cmwoI2dyYWQtdWNnZy1nZW5lcmF0ZWQpIiAvPgo8L3N2Zz4=);
background: -moz-linear-gradient(-45deg,  #21348a 1%, #3366cc 50%, #1fbaf2 100%); /* FF3.6+ */
background: -webkit-gradient(linear, left top, right bottom, color-stop(1%,#21348a), color-stop(50%,#3366cc), color-stop(100%,#1fbaf2)); /* Chrome,Safari4+ */
background: -webkit-linear-gradient(-45deg,  #21348a 1%,#3366cc 50%,#1fbaf2 100%); /* Chrome10+,Safari5.1+ */
background: -o-linear-gradient(-45deg,  #21348a 1%,#3366cc 50%,#1fbaf2 100%); /* Opera 11.10+ */
background: -ms-linear-gradient(-45deg,  #21348a 1%,#3366cc 50%,#1fbaf2 100%); /* IE10+ */
background: linear-gradient(135deg,  #21348a 1%,#3366cc 50%,#1fbaf2 100%); /* W3C */
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#21348a', endColorstr='#1fbaf2',GradientType=1 ); /* IE6-8 fallback on horizontal gradient */

        content: "";
        height: 2px;
        left: 0;
        position: absolute;
        right: 0;
    }

    .menu-link {
        color: white;
        display: block;
        padding: 0 1em;
        text-align: right;
        text-decoration: none;
    }


    input[type='submit'] {
        background: none;
        border: none;
        color: white;

        &:hover, &:focus, &:active { color: $coral; }
    }

    ul { 
        max-width: 1140px; 
        margin: 0 auto;
        width: 90%; 
    }

    /* ==================
     * Menu Icons */
    [class^="icon-"]:before, [class*=" icon-"]:before {
        /* ==================
         * White Menu Option */
        //color: rgba($gray-dark, .7);
        /* ==================
         * Blue Menu Option */
            color: lighten(#3366CC, 9%);            
        font-weight: normal;
        position: relative;
//        text-shadow: 1px 2px 6px #21348a, 0 0 0 #000, 1px 2px 6px #21348a;

    }

    .icon-calendar:before,
    .icon-home:before { margin-right: -.8em; top: 1px; }
    
    .icon-book:before,
    .icon-code:before, 
        li.icon-grid-view:before, // li to help differentiate from menu-link icon.
        .icon-help:before,
        .icon-info:before,
        .icon-pencil:before,
        .icon-keyboard:before,
        .icon-marker:before, 
        .icon-user:before,
        .icon-wifi:before,
        .icon-info:before,
        .icon-library:before,
        .icon-rocket:before,
        .icon-mobile:before { margin-right: -12px; }

    .icon-keyboard:before,
        .icon-code:before,
        .icon-help:before,
        .icon-home:before,
        .icon-grid-view:before,
        .icon-user:before,
        .icon-wifi:before,
        .icon-info:before,
        .icon-library:before,
        .icon-rocket:before,
        .icon-pencil:before { top: 1px; }

    a.icon-search:before,
    .menu-link.icon-grid-view:before {margin-right: .5em;}
    
    /* ==================
     * Top Level Menu Items */
    li {
        cursor: pointer;
        display: block;
        position: relative;
        //z-index: 2;
        @include css-transition(all, .2s, ease-out);

        &:hover, &:focus, &:active {
            color: white;
            &:before { color: $blue-light; }
            &:first-child {border-left: none;} 
        }

        &:first-child {
            border-left: none; 
        }
                
        a {
            /* ==================
             * White Menu Option */
            //color: $gray-dark;
            /* ==================
             * Blue Menu Option */
                color: lighten(#3366CC, 40%);
            text-decoration: none;
            padding: 0 1em;
            @include css-transition(all, .2s, ease-out);
            /*
            you can use hover styles here even though this size
            has the possibility of being a mobile device.
            */
            &:hover, &:focus, &:active { 
               /* ==================
                * Blue Menu Option */
                    color: white;
            /* ==================
             * White Menu Option */
                //color: $blue-light;
            }
        }

        &:first-child { margin-left: 0; }
        &:last-child { margin-right: 0; border-right: none;  border-bottom: none;}

        /* ==================
         * First Sub Menu */
        ul.sub-menu {
            display: none;
            z-index: 1000;
                        
            li {                
                //background: $blue-light url(textures/noise.png);
                background: white;
                border-bottom: 2px solid $gray-dark;
                text-align: left;
                

                a {
                    border-left: 6px solid lighten($blue-light, 15%);
                    color: $gray-dark;
                    display: block;
                    font-weight: normal;
                    margin: 0 auto;
                    padding: 0 .5em;

                    &:hover, &:focus, &:active, &.active {
                        border-left: 6px solid #1fbaf2;
                        color: $blue-light;
                    }
        
                    &:link {}
                }
        
                &:first-child {}
    
                &:last-child {
        
                    a {
                        border-bottom: 0;
                    }
                }
                        
                /*
                if you need to go deeper, go nuts
                just remember deeper menus suck
                for usability. k, bai.
                */
                ul { }

            }
                    
            /* highlight sub-menu current page */
            li.current-menu-item, 
            li.current_page_item,
            li.current-page-ancestor {
                a {}
            }

            small {}

        }
                
        /* showing sub-menus */
        //&:active >  ul { // change this to active
        //  top: auto;
        //  display: block;
        //}
                
    } /* end .menu ul li */

    li.active > ul {
        top: auto;
        display: block; 
    }

    li.has-subnav {

        .icon-arrow-right { float: right; margin-right: 1em; }

        ul.children {
            z-index:1; 
            display:none;

            li:first-child { border-top: 1px solid $gray-dark; }
        }

        ul.children.active {
            display: block;
        }

    }


    /* highlight current page */
    li.current-menu-item, 
    li.current_page_item,
    li.current-page-ancestor {
       // @include box-shadow(inset 0 0 2px 0 $gray-dark);;
        &:before { color: $blue-light; }
        a { color: $blue-light; }
    }  /* end current highlighters */
    
} /* end .menu */


.persistent {
    position: fixed; 
    height: auto !important;
    left: 0;
    right: 0;
    z-index: 2;
}

.persistent--bottom { 
    bottom: 0;
    margin-bottom: 0 !important;
}

.persistent--top { top: 0; }
.menu.persistent {
    box-shadow: inset 0 0 3px 0 $polaris-blue-light;
}

.lt-ie8 {
    .persistent { position: inherit !important; }
}

/* ==================
 * Mobile Menu Toggle */
.no-js .menu-link { display: none; }
.js .menu ul { display: none; }
.no-js .menu ul { display: block; }

/* ==================
 * Springboard */
#springboard {
    background: #444 url('textures/noise.png');    
    font-size: 14px;
    margin: -1em auto .25em;
    padding: 3em 0 0;
    text-align: center;

    a { 
        color: white;
        display: inline-block;
        width: 18%;

        &:before {
            font-size: 2.5em;
            margin-top: -.5em;
            position: absolute;
            text-shadow: 1px 0 4px #444;
        }

        &:first-child {
            margin-left: 0;
        }

        &:last-child {
            float: right;
        }

        &:active, &:focus {
            &:before { color: white; }
        }
    }

    .icon-book:before { margin-left: .3em; }
    .icon-calendar:before,
    .icon-key:before { margin-left: .1em; }
    .icon-map:before { margin-left: .3em; }
} // .springboard

.no-js .menu li:hover > ul { display: block; }
.no-js .menu ul.children:hover { display: block; }

/* ==================
 * Small Monitors
 * ================== */
 @media only screen and (min-width: 63.9375em) {
/* ==================
 * Mobile Menu Toggle */
.js .menu ul { display: block; }

.menu {

    .menu-link { display: none; }

    /* ==================
     * Top Level Menu Items */
    li.last ul.sub-menu li {
        float: right;
    }
    li {
        position: relative;
        display: inline-block;

        /* ==================
         * First Sub Menu */
        ul.sub-menu {
            position: absolute;
                        
            li {               
                text-indent: 0;
                min-width: 15em; // magic number

      
                &:first-child {}
    
                &:last-child {
                    
                }
                        
                /*
                if you need to go deeper, go nuts
                just remember deeper menus suck
                for usability. k, bai.
                */
                ul { }

            }
                    
            /* highlight sub-menu current page */
            li.current-menu-item, 
            li.current_page_item,
            li.current-page-ancestor {
                a {}
            }

            small {}

        }
                
        /* showing sub-menus */
        //&:active >  ul { // change this to active
        //  top: auto;
        //  display: block;
        //}
                
    } /* end .menu ul li */

    li.active > ul {
        top: auto;
        display: block; 
        margin-left: -1em;
        margin-top: 2px;
    }

    .last > li .sub-menu li { 
        min-width: 7em;
    }

    li.has-subnav {

        a[href="#parent"]:after {
            font-family: icomoon;
            color: #91CDEB;
            content: "o";
            float: right;
            //text-shadow: 1px 2px 6px $gray-dark, 0 0 0 #000, 1px 2px 6px $gray-dark;
        }

        ul.children {
            z-index:1; 
            display:none;
            width: auto;

            a {
                border-left: 6px solid lighten(#91CDEB, 9%);
            }

            li:first-child { border-top: 1px solid $gray-dark; }
            li:last-child {
                border-bottom: none;
            }
        }

        ul.children.active {
            display: block;
        }



    }


    /* highlight current page */
    li.current-menu-item, 
    li.current_page_item,
    li.current-page-ancestor {
        a {}
    }  /* end current highlighters */
    
} /* end .menu */
.menu > ul > li {
    border-left: 3px solid rgba($blue-light, .2);
    padding: 0 0 0 1em;
    &:first-child { padding-left: 0; }
    &:hover, &:active, &:focus {
      //  background: rgba($blue-light, .1);
        border-left: 3px solid $blue-light;
    }
}

}